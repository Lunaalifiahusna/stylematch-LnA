<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="StyleMatch ‚Äî rekomendasi outfit, colour harmony, style dictionary, mix & match, quiz, and outfit randomizer. Built with HTML, Tailwind, jQuery and Chart.js." />
  <title>StyleMatch ‚Äî Discover Your Perfect Outfit</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* --- ROOT VARIABLES & THEMES --- */
    :root{
      --bg: linear-gradient(180deg,#f8fafc,#e6eefc);
      --text: #334155; 
      --card: #ffffff;
      --accent: #2563eb;
      --muted: #64748b;
      --glass: rgba(255,255,255,0.75);
      --border: #e2e8f0;
      --bg-inner: #f1f5f9; 
    }

    /* Theme: Light */
    .theme-light { 
      --bg: linear-gradient(180deg,#f8fafc,#e6eefc); 
      --text:#334155; 
      --card:#ffffff; 
      --accent:#2563eb; 
      --muted:#64748b; 
      --glass: rgba(255,255,255,0.75);
      --border: #e2e8f0;
      --bg-inner: #f8fafc;
    }

    /* Theme: Dark (Fixed Contrast) */
    .theme-dark { 
      --bg: linear-gradient(180deg,#0f172a,#1e293b); 
      --text:#f1f5f9; 
      --card:#1e293b; 
      --accent:#818cf8; 
      --muted:#94a3b8; 
      --glass: rgba(30, 41, 59, 0.8);
      --border: #334155;
      --bg-inner: #334155; 
    }

    /* Theme: Pink-Blue */
    .theme-pinkblue { 
      --bg: linear-gradient(135deg,#fff0f6,#e6f0ff); 
      --text:#334155; 
      --card:#ffffff; 
      --accent:#ec4899; 
      --muted:#64748b; 
      --glass: rgba(255,255,255,0.75);
      --border: #fbcfe8;
      --bg-inner: #fff1f2;
    }

    /* Theme: Blue-Purple */
    .theme-bluepurple { 
      --bg: linear-gradient(135deg,#f0f7ff,#efe6ff); 
      --text:#334155; 
      --card:#ffffff; 
      --accent:#6366f1; 
      --muted:#64748b; 
      --glass: rgba(255,255,255,0.75);
      --border: #e0e7ff;
      --bg-inner: #faf5ff;
    }

    /* Theme: Blue-Green */
    .theme-bluegreen { 
      --bg: linear-gradient(135deg,#e6fff7,#e6f4ff); 
      --text:#334155; 
      --card:#ffffff; 
      --accent:#06b6d4; 
      --muted:#64748b; 
      --glass: rgba(255,255,255,0.75);
      --border: #cffafe;
      --bg-inner: #ecfeff;
    }

    /* --- GLOBAL STYLES --- */
    html,body{height:100%}
    body{
      font-family:"Plus Jakarta Sans",system-ui,-apple-system; 
      margin:0; 
      background:var(--bg); 
      color:var(--text); 
      transition:background .28s, color .28s; 
      -webkit-font-smoothing:antialiased; 
      -moz-osx-font-smoothing:grayscale;
    }

    /* Custom Classes to replace Tailwind hardcodes */
    .card { background:var(--card); border-radius:.75rem; box-shadow:0 10px 30px rgba(0,0,0,0.08); padding:1rem; color:var(--text); border: 1px solid var(--border); }
    .text-accent { color: var(--accent); }
    .bg-inner { background-color: var(--bg-inner); }
    .border-adaptive { border-color: var(--border); }
    .muted { color: var(--muted) !important; }

    /* Header */
    header.site-header{position:fixed;top:0;left:0;right:0;z-index:60;background:var(--glass);backdrop-filter: blur(12px);border-bottom:1px solid var(--border);}
    header.site-header .desktop-nav .nav-btn{color:var(--text);}
    .nav-btn:hover { background-color: var(--bg-inner); }
    .nav-btn.active{color: #ffffff; background:var(--accent); padding:.35rem .6rem; border-radius:.5rem}
    
    /* Buttons */
    a.cta, button.cta-btn {background:var(--accent); color:#fff; padding:.65rem 1rem; border-radius:.6rem; display:inline-block; text-decoration:none; cursor: pointer; transition: opacity 0.2s;}
    a.cta:hover, button.cta-btn:hover { opacity: 0.9; }
    
    /* Sidebar */
    #sidebar{position:fixed;left:-340px;top:0;height:100vh;width:320px;background:var(--card);z-index:80;box-shadow:10px 0 40px rgba(0,0,0,0.2);transition:left .32s;padding:1rem;overflow:auto; border-right: 1px solid var(--border);}
    #sidebar.open{left:0}
    
    /* Modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:100}
    .modal{width:95%;max-width:820px;background:var(--card);padding:1.2rem;border-radius:12px; color: var(--text); border: 1px solid var(--border);}
    
    /* Utils */
    .hidden-section{display:none}
    .hover-raise:hover{transform:translateY(-6px);transition:transform .18s}
    img.object-cover{object-fit:cover}
    
    /* Inputs & Selects (Crucial for Dark Mode) */
    select, input[type="number"] { 
      background: var(--bg-inner); 
      color: var(--text); 
      border:1px solid var(--border); 
      border-radius:8px; 
      padding: 0.5rem;
      outline: none;
    }
    select:focus, input:focus { border-color: var(--accent); }

    /* Aesthetic Elements */
    .chip{display:inline-block;padding:.25rem .5rem;border-radius:999px;background:var(--bg-inner);font-size:.85rem; color: var(--text); border: 1px solid var(--border);}
    .drop-slot{min-height:48px; transition: background 0.3s; background: var(--bg-inner); border: 1px solid var(--border); color: var(--text);}
    .hero-media { max-width:520px; width:100%; height:360px; border-radius:12px; overflow:hidden; box-shadow:0 12px 30px rgba(0,0,0,0.15); border: 1px solid var(--border); }
    
    /* Sticky Sidebar & Drag */
    .sticky-sidebar { position: sticky; top: 110px; height: fit-content; z-index: 10; }
    .drop-slot.drag-over { background: rgba(37, 99, 235, 0.1); border-color: var(--accent); border-style: dashed; }
    .card.selected-item { outline: 3px solid var(--accent); transform: scale(0.98); }
    .mix-item-card { touch-action: none; }

    /* Responsive */
    @media (max-width:768px){
      header.site-header .desktop-nav{display:none}
      header.site-header .mobile-hamb{display:block}
    }
    @media (min-width:769px){
      header.site-header .mobile-hamb{display:none}
    }
  </style>
</head>
<body class="theme-light">

  <aside id="sidebar" aria-hidden="true">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-bold text-accent">Menu</h3>
      <button id="closeSidebar" class="text-xl">‚úï</button>
    </div>
    <nav class="space-y-2">
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="home">Home</button>
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="color">Colour Harmony</button>
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="style">Style Dictionary</button>
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="mixmatch">Mix & Match</button>
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="tools">Tools</button>
      <button class="w-full text-left nav-btn p-2 rounded-md text-accent font-bold" data-target="saved">‚ù§Ô∏è Saved / Simpan</button>
    </nav>
    <hr class="my-4 border-adaptive" />
    <div>
      <div class="font-semibold mb-2">Theme</div>
      <div class="flex flex-col gap-2">
        <button class="theme-btn p-2 rounded border border-adaptive bg-inner hover:bg-gray-200 dark:hover:bg-slate-700 text-left" data-theme="light">‚òÄ Light</button>
        <button class="theme-btn p-2 rounded border border-adaptive bg-inner hover:bg-gray-200 dark:hover:bg-slate-700 text-left" data-theme="dark">üåô Dark (Fixed)</button>
        <button class="theme-btn p-2 rounded border border-adaptive bg-inner hover:bg-gray-200 dark:hover:bg-slate-700 text-left" data-theme="pinkblue">üíó Pink ‚Üí Blue</button>
        <button class="theme-btn p-2 rounded border border-adaptive bg-inner hover:bg-gray-200 dark:hover:bg-slate-700 text-left" data-theme="bluepurple">üíú Blue ‚Üí Purple</button>
        <button class="theme-btn p-2 rounded border border-adaptive bg-inner hover:bg-gray-200 dark:hover:bg-slate-700 text-left" data-theme="bluegreen">üíô Blue ‚Üí Green</button>
      </div>
    </div>
  </aside>

  <header class="site-header">
    <div class="max-w-6xl mx-auto flex items-center justify-between p-4">
      <div class="flex items-center gap-3">
        <button id="openSidebar" class="mobile-hamb text-2xl">‚ò∞</button>
        <a href="#" class="flex items-center gap-2 no-underline">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" class="rounded-full"><circle cx="12" cy="12" r="10" class="fill-accent" style="fill: var(--accent)"/></svg>
          <span class="text-xl font-bold text-accent">StyleMatch</span>
        </a>
      </div>

      <nav class="desktop-nav flex items-center gap-3 text-sm font-medium">
        <button class="nav-btn px-3 py-1 rounded" data-target="home">Home</button>
        <button class="nav-btn px-3 py-1 rounded" data-target="color">Colour Harmony</button>
        <button class="nav-btn px-3 py-1 rounded" data-target="style">Style Dictionary</button>
        <button class="nav-btn px-3 py-1 rounded" data-target="mixmatch">Mix & Match</button>
        <button class="nav-btn px-3 py-1 rounded" data-target="tools">Tools</button>
        <button class="nav-btn px-3 py-1 rounded text-accent font-bold" data-target="saved">Saved</button>
      </nav>

      <div class="flex items-center gap-3">
        <button id="themeToggle" title="Change theme" class="chip">Theme</button>
        <a href="#home" class="cta hidden md:inline-block">Start</a>
      </div>
    </div>
  </header>

  <main class="pt-28 pb-16">

    <section class="max-w-6xl mx-auto text-center px-4 py-12">
      <div class="rounded-2xl overflow-hidden card grid md:grid-cols-2 gap-6 items-center">
        <div class="p-6 text-left">
          <h1 class="text-3xl md:text-4xl font-bold mb-3">Temukan Outfit Terbaik Versi Dirimu</h1>
          <p class="muted mb-4">Rekomendasi outfit, colour harmony, style dictionary, mix & match, dan fitur lainnya ‚Äî sekarang dengan palette & vibe lebih kaya serta pengalaman dark theme yang lebih nyaman.</p>
          <div class="flex flex-wrap gap-3">
            <a href="#home" class="cta">Mulai Sekarang</a>
            <button id="exploreStyles" class="chip">Lihat Style Dictionary</button>
            <button id="tryPalette" class="chip">Jelajahi Colour Harmony</button>
          </div>
          <div class="mt-6 text-sm muted">Designed by Luna & Aurel ‚Äî Built with HTML, Tailwind, jQuery & Chart.js</div>
        </div>
        <div class="p-6 flex items-center justify-center">
          <div class="hero-media">
            <img src="beranda.jpg" alt="hero outfit modern" class="w-full h-full object-cover" />
          </div>
        </div>
      </div>
    </section>

    <section id="home" class="section max-w-3xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-accent mb-3">Temukan Gaya yang Cocok Untukmu</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block font-semibold mb-1">Pilih Gender:</label>
            <select id="gender" class="w-full">
              <option value="">-- Pilih --</option>
              <option value="female">Perempuan</option>
              <option value="male">Laki-laki</option>
            </select>
          </div>
          <div>
            <label class="block font-semibold mb-1">Pilih Warna Kulit:</label>
            <select id="skinTone" class="w-full">
              <option value="">-- Pilih --</option>
              <option value="light">Light (Putih)</option>
              <option value="warm">Warm (Kuning Langsat)</option>
              <option value="medium">Medium (Sawo Matang)</option>
              <option value="deep">Deep (Gelap)</option>
            </select>
          </div>

          <div>
            <label class="block font-semibold mb-1">Pilih Acara:</label>
            <select id="occasion" class="w-full">
              <option value="">-- Pilih --</option>
              <option value="casual">Kasual</option>
              <option value="formal">Formal</option>
              <option value="hangout">Hangout</option>
              <option value="campus">Kampus / Sekolah</option>
            </select>
          </div>
          <div>
            <label class="block font-semibold mb-1">Pilih Tempat (Indoor/Outdoor):</label>
            <select id="placeWhere" class="w-full">
              <option value="">-- Pilih --</option>
              <option value="indoor">Indoor</option>
              <option value="outdoor">Outdoor</option>
            </select>
          </div>

          <div>
            <label class="block font-semibold mb-1">Cuaca / Musim:</label>
            <select id="weatherWhere" class="w-full">
              <option value="">-- Pilih --</option>
              <option value="sunny">Cerah</option>
              <option value="rain">Hujan</option>
              <option value="cloudy">Mendung</option>
              <option value="hot">Terik</option>
              <option value="cold">Dingin</option>
            </select>
          </div>
          <div class="flex items-end">
            <button id="generateBtn" class="w-full cta-btn">Lihat Rekomendasi</button>
          </div>
        </div>

        <div id="result" class="mt-6 p-4 rounded hidden border-adaptive border-t">
          <div class="flex justify-between items-center mb-2">
            <h3 class="text-xl font-semibold text-accent">‚ú® Rekomendasi Kamu:</h3>
            <button id="saveRecBtn" class="text-sm border border-adaptive bg-inner text-accent px-3 py-1 rounded hover:opacity-80 transition">üíæ Simpan Hasil</button>
          </div>
          
          <p id="styleResult" class="mt-2"></p>
          <p id="colors" class="mt-1"></p>
          <p id="outfitText" class="mt-1"></p> 
          <div id="suggestions" class="mt-3 grid sm:grid-cols-2 gap-2"></div>
          
          <div id="recImagesContainer" class="mt-6 border-t border-adaptive pt-4 hidden">
            <h4 class="font-semibold mb-3 muted">‚ú® Item Pilihan untuk Gaya Ini:</h4>
            <div id="recImages" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
          </div>
        </div>
      </article>
    </section>

    <section id="color" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-accent">Colour Harmony</h2>
        <p class="text-sm muted mb-4">Klik palette untuk melihat kombinasi warna, simpan ke koleksi, dan lihat contoh cocok untuk style dan skin tone tertentu.</p>

        <div id="swatchGrid" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>

        <div class="mt-6 grid md:grid-cols-2 gap-4">
          <div class="card bg-inner">
            <h3 class="font-semibold">Selected Palette</h3>
            <div id="selectedPalette" class="flex gap-2 mt-2"></div>
            <p id="paletteInfo" class="text-sm muted mt-2"></p>
            <div class="flex gap-2 mt-3">
              <button id="savePalette" class="cta-btn">‚ù§Ô∏è Simpan ke Koleksi</button>
            </div>
          </div>
          <div class="card bg-inner">
            <h3 class="font-semibold">Skin Tone Harmony</h3>
            <div class="text-sm muted mb-3">Visualisasi proporsi warna.</div>
            <canvas id="skinToneChart" width="400" height="200"></canvas>
          </div>
        </div>
      </article>
    </section>

    <section id="style" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-accent">Style Dictionary</h2>
        <p class="text-sm muted mb-4">Klik card untuk melihat detail style lengkap.</p>

        <div class="mb-4 flex gap-2 flex-wrap">
          <button class="filter-btn px-3 py-1 rounded bg-accent text-white" data-filter="all">Semua</button>
          <button class="filter-btn px-3 py-1 rounded bg-inner hover:bg-gray-200 dark:hover:bg-slate-700" data-filter="modern">Modern</button>
          <button class="filter-btn px-3 py-1 rounded bg-inner hover:bg-gray-200 dark:hover:bg-slate-700" data-filter="classic">Classic</button>
          <button class="filter-btn px-3 py-1 rounded bg-inner hover:bg-gray-200 dark:hover:bg-slate-700" data-filter="street">Street</button>
          <button class="filter-btn px-3 py-1 rounded bg-inner hover:bg-gray-200 dark:hover:bg-slate-700" data-filter="elegant">Elegant</button>
          <button class="filter-btn px-3 py-1 rounded bg-inner hover:bg-gray-200 dark:hover:bg-slate-700" data-filter="minimal">Minimal</button>
          <button class="filter-btn px-3 py-1 rounded bg-inner hover:bg-gray-200 dark:hover:bg-slate-700" data-filter="retro">Retro</button>
        </div>

        <div id="styleGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
      </article>
    </section>

    <section id="mixmatch" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-accent">Mix & Match (Drag & Drop)</h2>
        <p class="text-sm muted mb-4">
          <strong>Cara Pakai:</strong> Drag item ke slot, ATAU klik item lalu klik slot tujuan (Tap-to-Fill).
        </p>

        <div class="grid md:grid-cols-3 gap-4 relative">
          <div id="mixItems" class="md:col-span-2 grid grid-cols-2 md:grid-cols-3 gap-3"></div>
          
          <div class="sticky-sidebar">
            <div class="card border-adaptive shadow-lg">
              <h3 class="font-semibold text-accent">Your Outfit</h3>
              <p class="text-xs muted mb-2">Susun outfit kamu di sini.</p>
              <div id="dropArea" class="mt-3 space-y-2">
                <div class="drop-slot p-2 rounded" data-slot="top">Top: <span class="slot-val font-medium">‚Äî</span></div>
                <div class="drop-slot p-2 rounded" data-slot="bottom">Bottom: <span class="slot-val font-medium">‚Äî</span></div>
                <div class="drop-slot p-2 rounded" data-slot="shoes">Shoes: <span class="slot-val font-medium">‚Äî</span></div>
                <div class="drop-slot p-2 rounded" data-slot="acc">Accessory: <span class="slot-val font-medium">‚Äî</span></div>
              </div>
              <button id="saveOutfit" class="mt-3 w-full cta-btn">Simpan ke "Outfit Saya"</button>
              <button id="clearOutfit" class="mt-2 w-full bg-inner border border-adaptive text-muted px-3 py-2 rounded transition text-sm hover:opacity-80">Reset Slot</button>
            </div>
          </div>
        </div>
      </article>
    </section>

    <section id="tools" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-accent">Tools</h2>
        <div class="grid md:grid-cols-3 gap-4 mt-4">
          
          <div class="card bg-inner border border-adaptive">
            <h3 class="font-semibold">What Vibes Are You?</h3>
            <p class="text-xs muted mb-2">Pilih vibe untuk melihat palet warna & style rekomendasi.</p>
            <div class="grid grid-cols-2 gap-2 mt-2">
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="cute">Cute</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="minimal">Minimal</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="elegant">Elegant</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="cool">Cool</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="cozy">Cozy</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="street">Street</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="retro">Retro</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="sporty">Sporty</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="academia">Academia</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="boho">Boho</button>
              <button class="vibe-btn p-2 rounded bg-card border border-adaptive hover:bg-inner transition" data-vibe="artsy">Artsy</button>
            </div>
            <div id="vibeResult" class="mt-4 text-sm p-3 rounded bg-card border border-adaptive hidden"></div>
          </div>

          <div class="card bg-inner border border-adaptive">
            <h3 class="font-semibold">Personal Shape Consultant</h3>
            <p class="text-xs muted mb-3">Analisis bentuk tubuh untuk saran outfit terbaik.</p>
            
            <div class="mb-2">
              <label class="text-xs font-bold">Tinggi (cm)</label>
              <input id="bpHeight" type="number" placeholder="160" class="w-full p-2 mt-1 bg-card" />
            </div>
            <div class="mb-2">
              <label class="text-xs font-bold">Berat (kg)</label>
              <input id="bpWeight" type="number" placeholder="55" class="w-full p-2 mt-1 bg-card" />
            </div>
            <div class="mb-3">
              <label class="text-xs font-bold">Bentuk Tubuh (Paling Dominan)</label>
              <select id="bpShape" class="w-full p-2 mt-1 bg-card">
                <option value="">-- Pilih Bentuk --</option>
                <option value="pear">Pear (Pinggul Lebar)</option>
                <option value="apple">Apple (Bagian Tengah Berisi)</option>
                <option value="hourglass">Hourglass (Proporsional)</option>
                <option value="rectangle">Rectangle (Lurus/Athletic)</option>
                <option value="inverted_triangle">Inverted Triangle (Bahu Lebar)</option>
              </select>
            </div>
            
            <button id="calcBP" class="mt-1 w-full cta-btn">Dapatkan Konsultasi</button>
            <div id="bpResult" class="mt-3 text-sm"></div>
          </div>

          <div class="space-y-4">
            <div class="card bg-inner border border-adaptive">
              <h3 class="font-semibold">Outfit Weather Match</h3>
              <select id="weatherSel" class="w-full p-2 mt-2 bg-card">
                <option value="">Pilih Cuaca</option>
                <option value="sunny">Cerah / Panas</option>
                <option value="rain">Hujan / Basah</option>
                <option value="cloudy">Mendung / Berangin</option>
                <option value="hot">Terik Matahari</option>
                <option value="cold">Dingin / AC</option>
              </select>
              <select id="placeSel" class="w-full p-2 mt-2 bg-card">
                <option value="">Indoor / Outdoor?</option>
                <option value="indoor">Indoor</option>
                <option value="outdoor">Outdoor</option>
              </select>
              <button id="weatherBtn" class="mt-2 w-full cta-btn">Lihat Opsi Outfit</button>
              <div id="weatherResult" class="mt-3 text-sm hidden"></div>
            </div>

            <div class="card bg-inner border border-adaptive">
              <h3 class="font-semibold">Outfit Gacha (Randomizer)</h3>
              <p class="text-xs muted mb-2">Bosan? Biarkan takdir memilihkan outfitmu!</p>
              <select id="gachaGender" class="w-full p-2 mt-1 bg-card">
                <option value="">Pilih Gender</option>
                <option value="female">Perempuan</option>
                <option value="male">Laki-laki</option>
              </select>
              <button id="gachaBtn" class="mt-2 w-full cta-btn">Putar Gacha üé≤</button>
              <div id="gachaResult" class="mt-3 text-sm p-2 border border-adaptive bg-card rounded hidden"></div>
            </div>
          </div>
        </div>
      </article>
    </section>

    <section id="saved" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-accent">Koleksi Simpanan Kamu ‚ù§Ô∏è</h2>
        <p class="muted">Semua hasil rekomendasi, palet warna, dan outfit yang pernah kamu simpan.</p>
      </div>

      <article class="card mb-8">
        <h3 class="text-xl font-semibold text-accent border-b border-adaptive pb-2 mb-4">üìù Riwayat Rekomendasi Quiz</h3>
        <div id="savedRecContainer" class="grid gap-4 grid-cols-1 md:grid-cols-2">
          <p class="muted text-sm p-2 bg-inner rounded">Belum ada rekomendasi disimpan.</p>
        </div>
      </article>

      <article class="card mb-8">
        <h3 class="text-xl font-semibold text-accent border-b border-adaptive pb-2 mb-4">üé® Palette Favorit</h3>
        <div id="savedPaletteContainer" class="grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3">
          <p class="muted text-sm p-2 bg-inner rounded">Belum ada palette disimpan.</p>
        </div>
      </article>

      <article class="card">
        <h3 class="text-xl font-semibold text-accent border-b border-adaptive pb-2 mb-4">üëï Outfit Saya (Mix & Match)</h3>
        <div id="savedOutfitContainer" class="grid gap-6 grid-cols-1 md:grid-cols-2">
          <p class="muted text-sm p-2 bg-inner rounded">Belum ada outfit yang disusun dan disimpan.</p>
        </div>
      </article>
    </section>

  </main>

  <div id="styleModal" class="hidden fixed inset-0 z-50 items-center justify-center">
    <div class="modal">
      <div class="flex justify-between items-start">
        <h3 id="modalTitle" class="text-xl font-bold"></h3>
        <button id="closeModal" class="text-xl text-accent">‚úï</button>
      </div>
      <img id="modalImg" src="https://via.placeholder.com/900x500/ADD8E6/ffffff?text=MODAL+IMAGE" alt="style image" class="w-full h-56 object-cover rounded mt-3" />
      <p id="modalDesc" class="muted mt-3"></p>
      <div id="modalTags" class="mt-3 flex gap-2 flex-wrap"></div>
    </div>
  </div>

  <footer class="max-w-6xl mx-auto text-center text-sm muted p-6">
    &copy; 2025 StyleMatch ‚Äî Luna & Aurel. Built with ‚ù§Ô∏è.
  </footer>

  <script>
  /* ======= Initialization & Safe helpers ======= */
  (function(){ /* isolate scope */
    // Simple helper
    function $(sel){ return jQuery(sel); }

    /* === DATA: MIX ITEMS DEFINED HERE === */
    const mixItems = [
      { id:'t1', slot:'top', name:'White Tee', img:'whitetee.jpg' },
      { id:'t2', slot:'top', name:'Hoodie', img:'hoodie.jpg' },
      { id:'b1', slot:'bottom', name:'Blue Jeans', img:'bluej.jpg' },
      { id:'b2', slot:'bottom', name:'Cargo Pants', img:'cargo.jpg' },
      { id:'s1', slot:'shoes', name:'Sneakers', img:'Sneakers.jpg' },
      { id:'a1', slot:'acc', name:'Beanie', img:'beanie.jpg' },
      { id:'t3', slot:'top', name:'Kemeja Oxford', img:'keem.jpg' },
      { id:'t4', slot:'top', name:'Blouse Sutra', img:'blouse.jpg' },
      { id:'t5', slot:'top', name:'Sweater / Knit', img:'swea.jpg' },
      { id:'t6', slot:'top', name:'Denim Shirt', img:'denimshrt.jpeg' },
      { id:'t7', slot:'top', name:'Turtle Neck', img:'turneck.jpeg' },
      { id:'b3', slot:'bottom', name:'Tailored Trousers', img:'tailtrous.jpeg' },
      { id:'b4', slot:'bottom', name:'Pleated Skirt', img:'pltdskrt.jpeg' },
      { id:'b5', slot:'bottom', name:'Chinos / Khaki', img:'chinos.jpeg' },
      { id:'b6', slot:'bottom', name:'Leather Skirt', img:'leathrskrt.jpeg' },
      { id:'b7', slot:'bottom', name:'Jogger Pants', img:'joggrspnts.jpeg' },
      { id:'s2', slot:'shoes', name:'Clean White Sneakers', img:'whitsneakr.jpeg' },
      { id:'s3', slot:'shoes', name:'Loafers', img:'loafr.jpeg' },
      { id:'s4', slot:'shoes', name:'Ankle Boots', img:'ankel.jpeg' },
      { id:'s5', slot:'shoes', name:'Heeled Pumps', img:'heelpum.jpeg' },
      { id:'a2', slot:'acc', name:'Tote Bag', img:'tote.jpeg' },
      { id:'a3', slot:'acc', name:'Belt', img:'belt.jpeg' },
      { id:'a4', slot:'acc', name:'Scarf', img:'scarf.jpeg' },
      { id:'a5', slot:'acc', name:'Necklace', img:'neckl.jpeg' },
      { id:'a6', slot:'acc', name:'Wristwatch', img:'wrist.jpeg' },
      { id:'a7', slot:'acc', name:'Bracelet', img:'brace.jpeg' },
      { id:'a8', slot:'acc', name:'Sunglasses', img:'sungls.jpeg' },
      { id:'a9', slot:'acc', name:'Ring', img:'ring.jpeg' },
      { id:'a10', slot:'acc', name:'Earring', img:'ear.jpeg' },
      { id:'a11', slot:'acc', name:'Headband', img:'head.jpeg' }
    ];

    const getItem = (id) => mixItems.find(x => x.id === id);

    const palettes = [
      { id:'sunset', name:'Soft Sunset', colors:['#FFB6DA','#FFD1E8','#C7DDFF','#89A9FF'], desc:'Romantic pastel palette' },
      { id:'violet', name:'Blue ‚Üí Purple', colors:['#A9C7FF','#C3A6FF','#ECD9FF','#F6F0FF'], desc:'Cool & modern vibes' },
      { id:'ocean', name:'Ocean Fresh', colors:['#8BE8D4','#A4D8FF','#DFF7FF','#EAFBF7'], desc:'Fresh & natural' },
      { id:'earth', name:'Warm Earth', colors:['#D6A77A','#B86B4A','#F3E8DC','#8B5E3C'], desc:'Terracotta & warm' },
      { id:'mono', name:'Neutral Mono', colors:['#F8F9FA','#E9EEF6','#CBD5E1','#9AA8B2'], desc:'Minimal clean' },
      { id:'bold', name:'Bold Accent', colors:['#FF6B6B','#FFD166','#06D6A0','#4D96FF'], desc:'Kontras tajam' },
      { id:'muted', name:'Muted Sophisticate', colors:['#E3D5FF','#D3EAFB','#FFF1E6','#E6E6E6'], desc:'Halus, office & chic' }
    ];

    const styleData = [
      { name:'Streetwear', category:'street', img:'stw.jpeg', desc:'Gaya kasual modern: hoodie, oversized, sneakers. Cocok untuk hangout & festival.', tags:['hangout','santai','youth'] },
      { name:'Vintage Classic', category:'retro', img:'vin.jpeg', desc:'Nuansa retro dengan warna earthy dan siluet klasik; cocok untuk pencinta detail dan tekstur.', tags:['retro','calm','classic'] },
      { name:'Korean Minimalist', category:'modern', img:'kor.jpeg', desc:'Siluet bersih, warna netral, rapi. Ideal untuk look daily dan campus.', tags:['kuliah','office'] },
      { name:'Elegant Formal', category:'elegant', img:'elfor.jpeg', desc:'Blazer, dress, material premium untuk formal event.', tags:['kerja','kondangan'] },
      { name:'Techwear', category:'street', img:'tech.jpeg', desc:'Futuristik, banyak kantong, material waterproof. Cocok untuk outdoor urban.', tags:['outdoor','night'] },
      { name:'Soft Romantic', category:'minimal', img:'sorom.jpeg', desc:'Pastel, flowy, dan detail renda; vibe lembut & dreamy.', tags:['pastel','soft'] },
      { name:'Monochrome Chic', category:'modern', img:'mmn.jpeg', desc:'Monokrom yang elegan; bermain dengan tekstur bukan warna.', tags:['minimal','workwear'] },
      { name:'Preppy Style', category:'classic', img:'prep.jpeg', desc:'Kesan bersih, teratur, dan berkelas. Polo shirt, kemeja Oxford, sweater rajut, blazer dengan lambang, celana khaki, loafers.', tags:['clean','campus','formal'] },
      { name:'Bohemian (Boho)', category:'retro', img:'boho.jpeg', desc:'Gaya yang bebas, artistik, dan terinspirasi dari alam atau budaya hippies. Mengutamakan tekstur dan motif etnik. Pakaian longgar, renda, sulaman.', tags:['art','nature','floral'] }
    ];

    // Theme Logic
    const savedTheme = localStorage.getItem('sm_theme') || 'light';
    document.body.className = 'theme-' + savedTheme;

    function setActiveNav(target){
      $('.nav-btn').removeClass('active').css('background','').css('color','');
      $('.nav-btn[data-target="'+target+'"]').addClass('active');
    }

    function showSection(id){
      $('.section').addClass('hidden-section');
      $('#'+id).removeClass('hidden-section');
      setActiveNav(id);
      if(id === 'saved') renderSavedPage();
    }

    showSection('home');

    $('#openSidebar').on('click', ()=> $('#sidebar').addClass('open'));
    $('#closeSidebar').on('click', ()=> $('#sidebar').removeClass('open'));
    $('#sidebar').on('click', (e)=> { if(e.target.id==='sidebar') $('#sidebar').removeClass('open'); });

    $(document).on('click','.nav-btn', function(){
      const t = $(this).data('target');
      if(t) { showSection(t); window.scrollTo({top:0,behavior:'smooth'}); }
      $('#sidebar').removeClass('open');
    });

    $('.cta').on('click', function(e){
      e.preventDefault(); showSection('home');
      $('html,body').animate({ scrollTop: $('#home h2').offset().top - 120 }, 500);
    });

    $('.theme-btn').on('click', function(){
      const t = $(this).data('theme') || 'light';
      document.body.className = 'theme-' + t;
      localStorage.setItem('sm_theme', t);
    });
    $('#themeToggle').on('click', function(){
      const current = (document.body.className || '').replace('theme-','') || 'light';
      const order = ['light','pinkblue','bluepurple','bluegreen','dark'];
      let i = order.indexOf(current);
      i = (i+1) % order.length;
      const next = order[i];
      document.body.className = 'theme-' + next;
      localStorage.setItem('sm_theme', next);
    });

    $('#exploreStyles').on('click', ()=> { showSection('style'); window.scrollTo({top:0,behavior:'smooth'}); });
    $('#tryPalette').on('click', ()=> { showSection('color'); window.scrollTo({top:0,behavior:'smooth'}); });

    /* ======= LOGIC REKOMENDASI & SIMPAN ======= */
    let currentRecommendation = null;

    function recommendEngine(inputs) {
      const { gender, skin, occasion, place, weather } = inputs;
      let result = { styles: [], palette: null, itemIds: [] };

      if (occasion === 'casual' || occasion === 'hangout') {
        result.styles = (place === 'outdoor') ? ['Streetwear', 'Bohemian'] : ['Korean Minimalist', 'Vintage'];
      } else if (occasion === 'formal') {
        result.styles = ['Elegant Formal', 'Monochrome Chic'];
      } else if (occasion === 'campus') {
        result.styles = ['Preppy Style', 'Korean Minimalist'];
      }

      let paletteId = 'mono';
      if (skin === 'warm') paletteId = (occasion === 'casual') ? 'earth' : 'mono';
      else if (skin === 'light') paletteId = (occasion === 'formal') ? 'muted' : 'sunset';
      else if (skin === 'medium') paletteId = 'ocean';
      else if (skin === 'deep') paletteId = 'bold';
      if(occasion === 'formal') paletteId = 'mono';
      result.palette = palettes.find(p => p.id === paletteId);

      let topId='t1', botId='b1', shoeId='s1', accId='a2';
      if (occasion === 'formal') { topId = (gender==='female')?'t4':'t3'; botId=(gender==='female')?'b4':'b3'; shoeId=(gender==='female')?'s5':'s3'; accId='a6'; }
      else if (weather==='rain') { topId='t2'; shoeId='s4'; }
      else if (weather==='sunny' && place==='outdoor') { accId='a8'; shoeId='s2'; }
      
      if (gender === 'female' && occasion === 'casual' && weather === 'sunny' && skin === 'warm' && place === 'outdoor') {
        result.styles = ['Streetwear', 'Korean Minimalist'];
        result.palette = palettes.find(p => p.id === 'mono');
        topId = 't1'; botId = 'b1'; shoeId = 's2'; accId = 'a8';
      }
      result.itemIds = [topId, botId, shoeId, accId];
      return result;
    }

    $('#generateBtn').on('click', function(){
      const inputs = {
        gender: $('#gender').val(),
        skin: $('#skinTone').val(),
        occasion: $('#occasion').val(),
        place: $('#placeWhere').val(),
        weather: $('#weatherWhere').val()
      };
      if(!inputs.gender || !inputs.skin || !inputs.occasion){ alert('Mohon lengkapi pilihan.'); return; }
      
      const rec = recommendEngine(inputs);
      
      currentRecommendation = {
        id: Date.now(),
        date: new Date().toLocaleDateString(),
        inputs: inputs,
        rec: rec
      };

      $('#styleResult').html('<strong>Gaya:</strong> ' + rec.styles.join(', '));
      $('#colors').html('<strong>Warna cocok:</strong> ' + (rec.palette ? rec.palette.name : '-'));
      const itemNames = rec.itemIds.map(id => (getItem(id) ? getItem(id).name : '')).join(', ');
      $('#outfitText').html('<strong>Outfit:</strong> ' + itemNames);

      $('#recImages').html('');
      $('#recImagesContainer').removeClass('hidden');
      rec.itemIds.forEach(id => {
        const item = getItem(id);
        if(item) {
          $('#recImages').append(`
            <div class="card p-2 text-center border border-adaptive bg-inner">
              <div class="w-full h-28 overflow-hidden rounded-md mb-2 bg-card">
                <img src="${item.img}" class="w-full h-full object-cover" alt="${item.name}">
              </div>
              <div class="text-xs font-bold">${item.name}</div>
            </div>
          `);
        }
      });
      $('#result').removeClass('hidden');
      $('html,body').animate({scrollTop: $('#result').offset().top - 80}, 400);
    });

    $('#saveRecBtn').on('click', function(){
      if(!currentRecommendation) return;
      let saved = JSON.parse(localStorage.getItem('sm_saved_recs') || '[]');
      saved.push(currentRecommendation);
      localStorage.setItem('sm_saved_recs', JSON.stringify(saved));
      alert('Rekomendasi berhasil disimpan! Cek menu Saved.');
    });

    /* ======= Colour Harmony ======= */
    function renderSwatches(){
      $('#swatchGrid').html('');
      palettes.forEach(p => {
        $('#swatchGrid').append(`<div class="p-3 card cursor-pointer border-adaptive" data-id="${p.id}">
          <div class="grid grid-cols-4 gap-1 mb-3">${p.colors.map(c=>`<div style="background:${c}" class="h-12 rounded"></div>`).join('')}</div>
          <div class="font-semibold">${p.name}</div><div class="text-xs muted">${p.desc}</div></div>`);
      });
    }
    renderSwatches();

    let currentPalette = null;
    $(document).on('click','#swatchGrid .card', function(){
      const id = $(this).data('id');
      const p = palettes.find(x=>x.id===id);
      currentPalette = p;
      $('#selectedPalette').html(p.colors.map(c=>`<div style="background:${c}" class="w-14 h-10 rounded border"></div>`).join(''));
      $('#paletteInfo').text(p.desc);
      const ctx = document.getElementById('skinToneChart').getContext('2d');
      if(window.mySkinChart) window.mySkinChart.destroy();
      window.mySkinChart = new Chart(ctx, {
        type:'pie',
        data:{labels:['Primary','Accent','Support','Neutral'], datasets:[{data:[40,25,20,15], backgroundColor:p.colors.slice(0,4)}]},
        options:{responsive:true}
      });
    });

    $('#savePalette').on('click', function(){
      if(!currentPalette) { alert('Pilih palette dulu'); return; }
      let saved = JSON.parse(localStorage.getItem('sm_saved_palettes') || '[]');
      if(saved.some(x => x.id === currentPalette.id)) { alert('Palette ini sudah tersimpan.'); return; }
      saved.push(currentPalette);
      localStorage.setItem('sm_saved_palettes', JSON.stringify(saved));
      alert('Palette disimpan ke Koleksi!');
    });

    /* ======= Style Dictionary ======= */
    function renderGrid(filter='all'){
      $('#styleGrid').hide().html('');
      styleData.forEach((s,i)=>{
        if(filter!=='all' && s.category!==filter) return;
        const card = `<div class="card hover-raise cursor-pointer" role="button" data-index="${i}">
          <div class="w-full h-48 overflow-hidden rounded mb-2 border border-adaptive"><img src="${s.img}" alt="${s.name}" class="w-full h-full object-cover"></div>
          <h4 class="font-semibold">${s.name}</h4>
          <p class="text-sm muted">${s.desc.substring(0,80)}...</p>
        </div>`;
        $('#styleGrid').append(card);
      });
      $('#styleGrid').fadeIn(180);
    }
    renderGrid();

    $(document).on('click','.filter-btn', function(){
      $('.filter-btn').removeClass('bg-accent text-white').addClass('bg-inner');
      $(this).removeClass('bg-inner').addClass('bg-accent text-white');
      const f = $(this).data('filter') || 'all';
      renderGrid(f);
    });

    $(document).on('click','#styleGrid [data-index]', function(){
      const i = $(this).data('index');
      const s = styleData[i];
      $('#modalTitle').text(s.name);
      $('#modalImg').attr('src', s.img).attr('alt', s.name);
      $('#modalDesc').text(s.desc);
      $('#modalTags').html(s.tags.map(t=>`<span class="chip">${t}</span>`).join(' '));
      $('#styleModal').removeClass('hidden').addClass('modal-backdrop');
    });
    $('#closeModal').on('click', ()=> $('#styleModal').addClass('hidden').removeClass('modal-backdrop'));
    $('#styleModal').on('click', function(e){ if(e.target.id==='styleModal') { $(this).addClass('hidden').removeClass('modal-backdrop'); }});

    /* ======= Mix & Match ======= */
    function renderMixItems(){
      $('#mixItems').html('');
      mixItems.forEach(it=>{
        $('#mixItems').append(`<div draggable="true" data-id="${it.id}" data-slot="${it.slot}" class="card cursor-grab mix-item-card hover-raise">
          <div class="w-full h-36 overflow-hidden rounded mb-2 pointer-events-none bg-inner"><img src="${it.img}" alt="${it.name}" class="w-full h-full object-cover" /></div>
          <div class="font-semibold pointer-events-none">${it.name}</div><div class="text-xs muted pointer-events-none">slot: ${it.slot}</div></div>`);
      });
    }
    renderMixItems();

    let dragData = null;
    $(document).on('dragstart','[draggable="true"]', function(e){ dragData = { id: $(this).data('id'), slot: $(this).data('slot'), name: $(this).find('.font-semibold').text() }; });
    document.addEventListener('dragover', function(e){ 
      const threshold = 50; if (e.clientY < threshold) window.scrollBy(0, -15); else if (e.clientY > (window.innerHeight - threshold)) window.scrollBy(0, 15); 
    });
    $('.drop-slot').each(function(){
      this.addEventListener('dragover', function(e){ e.preventDefault(); $(this).addClass('drag-over'); });
      this.addEventListener('dragleave', function(e){ $(this).removeClass('drag-over'); });
      this.addEventListener('drop', function(e){
        e.preventDefault(); $(this).removeClass('drag-over');
        if(dragData && dragData.slot === $(this).data('slot')) {
          $(this).find('.slot-val').text(dragData.name).addClass('text-accent');
          $(this).data('item', dragData.id);
        }
      });
    });
    
    let selectedTapItem = null;
    $(document).on('click', '.mix-item-card', function(){
      $('.mix-item-card').removeClass('selected-item border-accent ring-2 ring-blue-500');
      if (selectedTapItem && selectedTapItem.id === $(this).data('id')) { selectedTapItem = null; return; }
      $(this).addClass('selected-item border-accent ring-2 ring-blue-500');
      selectedTapItem = { id: $(this).data('id'), slot: $(this).data('slot'), name: $(this).find('.font-semibold').text() };
    });
    $('.drop-slot').on('click', function(){
      if(!selectedTapItem) return;
      if(selectedTapItem.slot === $(this).data('slot')) {
        $(this).find('.slot-val').text(selectedTapItem.name).addClass('text-accent');
        $(this).data('item', selectedTapItem.id);
        $('.mix-item-card').removeClass('selected-item border-accent ring-2 ring-blue-500');
        selectedTapItem = null;
      }
    });

    $('#saveOutfit').on('click', function(){
      const out = {};
      let hasItem = false;
      $('.drop-slot').each(function(){ 
        const val = $(this).data('item'); 
        out[$(this).data('slot')] = val || null;
        if(val) hasItem = true;
      });
      if(!hasItem) { alert('Slot masih kosong!'); return; }
      const outfitObj = { id: Date.now(), date: new Date().toLocaleDateString(), items: out };
      let saved = JSON.parse(localStorage.getItem('sm_saved_outfits') || '[]');
      saved.push(outfitObj);
      localStorage.setItem('sm_saved_outfits', JSON.stringify(saved));
      alert('Outfit disimpan ke Outfit Saya!');
    });
    
    $('#clearOutfit').on('click', function(){
      $('.drop-slot').each(function(){ $(this).find('.slot-val').text('‚Äî').removeClass('text-accent'); $(this).removeData('item'); });
    });

    /* ======= SAVED PAGE RENDERING LOGIC ======= */
    window.deleteSavedItem = function(type, id) {
      if(!confirm('Hapus item ini?')) return;
      const key = type === 'rec' ? 'sm_saved_recs' : (type === 'pal' ? 'sm_saved_palettes' : 'sm_saved_outfits');
      let list = JSON.parse(localStorage.getItem(key) || '[]');
      list = list.filter(x => x.id !== id);
      localStorage.setItem(key, JSON.stringify(list));
      renderSavedPage(); 
    };

    function renderSavedPage() {
      const recs = JSON.parse(localStorage.getItem('sm_saved_recs') || '[]');
      const recContainer = $('#savedRecContainer');
      recContainer.html('');
      if(recs.length === 0) recContainer.html('<p class="muted col-span-2 p-4 bg-inner rounded">Belum ada rekomendasi tersimpan.</p>');
      else {
        recs.forEach(r => {
          const thumbs = r.rec.itemIds.map(tid => { const item = getItem(tid); return item ? `<img src="${item.img}" class="w-8 h-8 rounded object-cover border border-adaptive">` : ''; }).join('');
          recContainer.append(`<div class="card border-adaptive relative"><button onclick="deleteSavedItem('rec', ${r.id})" class="absolute top-2 right-2 text-red-400 hover:text-red-600">üóëÔ∏è</button><div class="text-xs text-accent font-bold mb-1">${r.date}</div><div class="font-semibold text-sm mb-1">${r.rec.styles[0]}</div><div class="text-xs muted mb-2">Palette: ${r.rec.palette.name}</div><div class="flex gap-1 mt-2">${thumbs}</div></div>`);
        });
      }

      const pals = JSON.parse(localStorage.getItem('sm_saved_palettes') || '[]');
      const palContainer = $('#savedPaletteContainer');
      palContainer.html('');
      if(pals.length === 0) palContainer.html('<p class="muted col-span-2 p-4 bg-inner rounded">Belum ada palette tersimpan.</p>');
      else {
        pals.forEach(p => {
          const colorsHtml = p.colors.map(c => `<div style="background:${c}" class="h-8 w-8 rounded-full border shadow-sm"></div>`).join('');
          palContainer.append(`<div class="card border-adaptive relative"><button onclick="deleteSavedItem('pal', '${p.id}')" class="absolute top-2 right-2 text-red-400 hover:text-red-600">üóëÔ∏è</button><div class="font-bold">${p.name}</div><div class="flex gap-1 my-2 justify-center">${colorsHtml}</div><div class="text-xs muted">${p.desc}</div></div>`);
        });
      }

      const outfits = JSON.parse(localStorage.getItem('sm_saved_outfits') || '[]');
      const outContainer = $('#savedOutfitContainer');
      outContainer.html('');
      if(outfits.length === 0) outContainer.html('<p class="muted col-span-2 p-4 bg-inner rounded">Belum ada outfit tersimpan.</p>');
      else {
        outfits.forEach(o => {
          let gridHtml = '';
          ['top','bottom','shoes','acc'].forEach(slot => { const iId = o.items[slot]; const it = getItem(iId); if(it) { gridHtml += `<div class="flex flex-col items-center p-2 bg-inner rounded border border-adaptive"><img src="${it.img}" class="w-16 h-16 object-cover rounded mb-1"><span class="text-[10px] muted uppercase">${slot}</span></div>`; } });
          outContainer.append(`<div class="card border-adaptive relative"><button onclick="deleteSavedItem('out', ${o.id})" class="absolute top-2 right-2 text-red-400 hover:text-red-600">üóëÔ∏è</button><div class="text-xs text-accent font-bold mb-2">Outfit ${o.date}</div><div class="grid grid-cols-4 gap-2">${gridHtml || '<div class="text-sm muted col-span-4">Item data error/missing</div>'}</div></div>`);
        });
      }
    }

    /* ======= MODIFIED TOOLS LOGIC ======= */
    
    /* 1. Modified Vibe Map (Added new vibes & styles) */
    const vibeMap = {
      cute: { desc: 'Soft pastel, playful, lovely.', colors: ['#FFD6E0', '#FFDCAE', '#C7DDFF'], style: 'Soft Romantic' },
      minimal: { desc: 'Neutral, clean lines, simple.', colors: ['#F8FAFC', '#CBD5E1', '#9AA8B2'], style: 'Korean Minimalist' },
      elegant: { desc: 'Tailored, rich, classy.', colors: ['#1F2937', '#6B7280', '#F3E8DC'], style: 'Elegant Formal' },
      cool: { desc: 'Edgy, monochrome, sharp.', colors: ['#0F172A', '#334155', '#89A9FF'], style: 'Techwear' },
      cozy: { desc: 'Warm knits, comfy, earthy.', colors: ['#F7D6B3', '#C6A78B', '#EAFBF7'], style: 'Vintage Classic' },
      street: { desc: 'Urban, oversized, hype.', colors: ['#111827', '#6B7280', '#B8B8B8'], style: 'Streetwear' },
      // New Vibes
      retro: { desc: 'Nostalgic, vibrant patterns, old-school.', colors: ['#D97706', '#F59E0B', '#78350F'], style: 'Vintage Classic' },
      sporty: { desc: 'Active, comfortable, athletic.', colors: ['#EF4444', '#3B82F6', '#FFFFFF'], style: 'Streetwear' },
      academia: { desc: 'Scholarly, tweed, dark tones.', colors: ['#4B2E2E', '#3F3F46', '#D4D4D8'], style: 'Preppy Style' },
      boho: { desc: 'Free-spirited, patterns, artistic.', colors: ['#B45309', '#ECFCCB', '#713F12'], style: 'Bohemian (Boho)' },
      artsy: { desc: 'Creative, colorful, unique.', colors: ['#F472B6', '#A78BFA', '#34D399'], style: 'Monochrome Chic' }
    };

    $(document).on('click', '.vibe-btn', function() {
      const v = $(this).data('vibe');
      const info = vibeMap[v];
      $('#vibeResult').removeClass('hidden').html(`
        <strong class="text-accent text-lg uppercase">${v}</strong>
        <p class="text-sm mb-2">${info.desc}</p>
        <div class="flex gap-2 mb-2">${info.colors.map(c => `<div style="background:${c}" class="w-8 h-8 rounded border border-gray-200 shadow-sm"></div>`).join('')}</div>
        <div class="text-xs font-bold mt-2">Rekomendasi Style: <span class="text-blue-500">${info.style}</span></div>
      `);
    });

    /* 2. Modified Body Proportion (Shape Consultant) */
    const shapeAdvice = {
      pear: { focus: "Balance lower body width.", dos: "A-line skirts, bootcut pants, detail on shoulders.", donts: "Skinny jeans with light colors." },
      apple: { focus: "Highlight legs & d√©colletage.", dos: "V-neck tops, empire waist, structured jackets.", donts: "Belts on natural waist." },
      hourglass: { focus: "Define the waist.", dos: "Wrap dresses, high-waist belts, fitted tops.", donts: "Boxy or shapeless oversized tops." },
      rectangle: { focus: "Create curves.", dos: "Ruffles, peplum tops, belted coats, layered tops.", donts: "Square necklines without detailing." },
      inverted_triangle: { focus: "Balance broad shoulders.", dos: "Wide-leg pants, full skirts, V-necks.", donts: "Puffy sleeves, shoulder pads." }
    };

    $('#calcBP').on('click', function() {
      const h = parseFloat($('#bpHeight').val());
      const w = parseFloat($('#bpWeight').val());
      const shape = $('#bpShape').val();

      if (!h || !w || !shape) { alert('Mohon isi tinggi, berat, dan bentuk tubuh.'); return; }
      
      const bmi = (w / ((h / 100) * (h / 100))).toFixed(1);
      const advice = shapeAdvice[shape];

      $('#bpResult').html(`
        <div class="p-3 bg-card border border-adaptive rounded shadow-sm">
          <div class="font-bold text-accent mb-1">Hasil Analisis:</div>
          <div class="text-xs mb-2">BMI: ${bmi}</div>
          <div class="text-sm font-semibold mb-1">Strategi ${shape.replace('_', ' ').toUpperCase()}:</div>
          <ul class="list-disc pl-4 text-xs space-y-1 muted">
            <li><strong>Fokus:</strong> ${advice.focus}</li>
            <li><strong>Do's:</strong> ${advice.dos}</li>
            <li><strong>Avoid:</strong> ${advice.donts}</li>
          </ul>
        </div>
      `);
    });

    /* 3. Modified Weather Match (Alternatives) */
    const weatherMapAdvanced = {
      sunny: { main: 'Kaos ringan, topi, kacamata hitam', alt: 'Tank top, kemeja linen, sandal' },
      rain: { main: 'Hoodie + waterproof jacket, sepatu anti air', alt: 'Trench coat, payung, boots karet' },
      cloudy: { main: 'Layering ringan, jaket denim', alt: 'Cardigan, kaos lengan panjang' },
      hot: { main: 'Atasan adem, celana pendek / linen', alt: 'Dress katun, rok flowy, topi lebar' },
      cold: { main: 'Coat, knit sweater, boots', alt: 'Puffer jacket, thermal inner, syal tebal' }
    };

    $('#weatherBtn').on('click', function() {
      const w = $('#weatherSel').val();
      const p = $('#placeSel').val();
      if (!w || !p) { alert('Pilih cuaca & tempat dulu'); return; }
      
      const info = weatherMapAdvanced[w];
      const placeNote = (p === 'outdoor' ? ' (Outdoor: Gunakan sunscreen/topi)' : ' (Indoor: Bawa luaran tipis jika AC dingin)');
      
      $('#weatherResult').removeClass('hidden').html(`
        <div class="p-2 bg-card rounded border border-adaptive">
          <div class="font-bold text-accent mb-1">Opsi Utama:</div>
          <div class="text-sm mb-2">${info.main} ${placeNote}</div>
          <div class="font-bold text-muted text-xs mb-1">Alternatif:</div>
          <div class="text-sm muted">${info.alt}</div>
        </div>
      `);
    });

    /* 4. Modified Randomizer (True Gacha) */
    function getRandomItem(slot) {
      const items = mixItems.filter(i => i.slot === slot);
      return items[Math.floor(Math.random() * items.length)];
    }

    const gachaMoods = ["Casual Day Out", "Date Night", "Office Chic", "Lazy Sunday", "Coffee Run", "Adventure Time"];

    $('#gachaBtn').on('click', function() {
      const g = $('#gachaGender').val();
      if (!g) { alert('Pilih gender dulu'); return; }

      // True Random Logic
      const top = getRandomItem('top');
      const bot = getRandomItem('bottom');
      const shoe = getRandomItem('shoes');
      const acc = getRandomItem('acc'); // Optional accessories
      const mood = gachaMoods[Math.floor(Math.random() * gachaMoods.length)];

      $('#gachaResult').removeClass('hidden').html(`
        <div class="text-center">
          <div class="text-xs uppercase tracking-widest text-muted mb-1">Mood: ${mood}</div>
          <div class="font-bold text-accent text-lg mb-2">‚ú® ${top.name} + ${bot.name} ‚ú®</div>
          <div class="text-sm muted mb-2">with ${shoe.name} & ${acc.name}</div>
          <div class="flex justify-center gap-1 mt-2">
             <img src="${top.img}" class="w-8 h-8 rounded border object-cover">
             <img src="${bot.img}" class="w-8 h-8 rounded border object-cover">
             <img src="${shoe.img}" class="w-8 h-8 rounded border object-cover">
          </div>
        </div>
      `);
    });

    // Scroll sync disabled
    $(window).on('scroll', function(){});

    if(localStorage.getItem('sm_savedOutfit')){
      const saved = JSON.parse(localStorage.getItem('sm_savedOutfit'));
      $('.drop-slot').each(function(){ const s=$(this).data('slot'); if(saved[s]) $(this).find('.slot-val').text(saved[s]); });
    }
    $(document).on('keydown', function(e){ if(e.key === 'Escape'){ $('#sidebar').removeClass('open'); $('#styleModal').addClass('hidden').removeClass('modal-backdrop'); } });

  })();
  </script>
</body>
</html>