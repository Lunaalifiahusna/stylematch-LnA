<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="StyleMatch ‚Äî rekomendasi outfit, colour harmony, style dictionary, mix & match, quiz, and outfit randomizer. Built with HTML, Tailwind, jQuery and Chart.js." />
  <title>StyleMatch ‚Äî Discover Your Perfect Outfit</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: linear-gradient(180deg,#f8fafc,#e6eefc);
      --text: #0f172a;
      --card: #fff;
      --accent: #2563eb;
      --muted: #6b7280;
      --glass: rgba(255,255,255,0.6);
    }
    /* Theme vars */
    .theme-light { --bg: linear-gradient(180deg,#f8fafc,#e6eefc); --text:#0f172a; --card:#ffffff; --accent:#2563eb; --muted:#6b7280; --glass: rgba(255,255,255,0.6); }
    .theme-dark { --bg: linear-gradient(180deg,#071021,#041018); --text:#e6eefc; --card:#071428; --accent:#7c3aed; --muted:#9aa6bb; --glass: rgba(8,12,20,0.6); }
    .theme-pinkblue { --bg: linear-gradient(135deg,#fff0f6,#e6f0ff); --text:#0f172a; --card:#ffffff; --accent:#ec4899; --muted:#6b7280; --glass: rgba(255,255,255,0.7); }
    .theme-bluepurple { --bg: linear-gradient(135deg,#f0f7ff,#efe6ff); --text:#0f172a; --card:#ffffff; --accent:#6366f1; --muted:#6b7280; --glass: rgba(255,255,255,0.7); }
    .theme-bluegreen { --bg: linear-gradient(135deg,#e6fff7,#e6f4ff); --text:#0f172a; --card:#ffffff; --accent:#06b6d4; --muted:#6b7280; --glass: rgba(255,255,255,0.7); }

    html,body{height:100%}
    body{font-family:"Plus Jakarta Sans",system-ui,-apple-system; margin:0; background:var(--bg); color:var(--text); transition:background .28s,color .28s; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    .card{background:var(--card); border-radius:.75rem; box-shadow:0 10px 30px rgba(2,6,23,0.06); padding:1rem; color:var(--text)}
    header.site-header{position:fixed;top:0;left:0;right:0;z-index:60;background:var(--glass);backdrop-filter: blur(8px);border-bottom:1px solid rgba(0,0,0,0.06)}
    header.site-header .desktop-nav .nav-btn{color:var(--text)}
    .nav-btn.active{color:var(--card); background:var(--accent); padding:.35rem .6rem; border-radius:.5rem}
    a.cta{background:var(--accent); color:#fff; padding:.65rem 1rem; border-radius:.6rem; display:inline-block; text-decoration:none}
    /* Sidebar */
    #sidebar{position:fixed;left:-340px;top:0;height:100vh;width:320px;background:var(--card);z-index:80;box-shadow:10px 0 40px rgba(2,6,23,0.12);transition:left .32s;padding:1rem;overflow:auto}
    #sidebar.open{left:0}
    /* Modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(3,7,18,0.6);display:flex;align-items:center;justify-content:center;z-index:100}
    .modal{width:95%;max-width:820px;background:var(--card);padding:1.2rem;border-radius:12px}
    /* small helpers */
    .hidden-section{display:none}
    .hover-raise:hover{transform:translateY(-6px);transition:transform .18s}
    img.object-cover{object-fit:cover}
    /* responsive tweaks */
    @media (max-width:768px){
      header.site-header .desktop-nav{display:none}
      header.site-header .mobile-hamb{display:block}
    }
    @media (min-width:769px){
      header.site-header .mobile-hamb{display:none}
    }
    /* aesthetic */
    .chip{display:inline-block;padding:.25rem .5rem;border-radius:999px;background:rgba(0,0,0,0.06);font-size:.85rem}
    /* drop slot */
    .drop-slot{min-height:48px}
    /* improved image frame */
    .hero-media { max-width:520px; width:100%; height:360px; border-radius:12px; overflow:hidden; box-shadow:0 12px 30px rgba(2,6,23,0.08) }
    /* better contrast for dark theme actionable items */
    .theme-dark .chip{background:rgba(255,255,255,0.04)}
    .theme-dark header.site-header{border-bottom:1px solid rgba(255,255,255,0.04)}
    /* utility */
    .muted { color: var(--muted) }
    /* make buttons and selects look consistent */
    select, input[type="number"] { background: transparent; border:1px solid rgba(15,23,42,0.08); border-radius:8px }
    .theme-dark select, .theme-dark input[type="number"] { border:1px solid rgba(255,255,255,0.06) }
  </style>
</head>
<body class="theme-light">

  <aside id="sidebar" aria-hidden="true">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-bold">Menu</h3>
      <button id="closeSidebar" class="text-xl">‚úï</button>
    </div>
    <nav class="space-y-2">
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="home">Home</button>
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="color">Colour Harmony</button>
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="style">Style Dictionary</button>
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="mixmatch">Mix & Match</button>
      <button class="w-full text-left nav-btn p-2 rounded-md" data-target="tools">Tools</button>
    </nav>
    <hr class="my-4" />
    <div>
      <div class="font-semibold mb-2">Theme</div>
      <div class="flex flex-col gap-2">
        <button class="theme-btn p-2 rounded" data-theme="light">‚òÄ Light</button>
        <button class="theme-btn p-2 rounded" data-theme="dark">üåô Dark</button>
        <button class="theme-btn p-2 rounded" data-theme="pinkblue">üíó Pink ‚Üí Blue</button>
        <button class="theme-btn p-2 rounded" data-theme="bluepurple">üíú Blue ‚Üí Purple</button>
        <button class="theme-btn p-2 rounded" data-theme="bluegreen">üíô Blue ‚Üí Green</button>
      </div>
    </div>
  </aside>

  <header class="site-header">
    <div class="max-w-6xl mx-auto flex items-center justify-between p-4">
      <div class="flex items-center gap-3">
        <button id="openSidebar" class="mobile-hamb text-2xl">‚ò∞</button>
        <a href="#" class="flex items-center gap-2">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" class="rounded-full"><circle cx="12" cy="12" r="10" fill="#93c5fd"/></svg>
          <span class="text-xl font-semibold">StyleMatch</span>
        </a>
      </div>

      <nav class="desktop-nav flex items-center gap-3 text-sm font-medium">
        <button class="nav-btn px-3 py-1 rounded" data-target="home">Home</button>
        <button class="nav-btn px-3 py-1 rounded" data-target="color">Colour Harmony</button>
        <button class="nav-btn px-3 py-1 rounded" data-target="style">Style Dictionary</button>
        <button class="nav-btn px-3 py-1 rounded" data-target="mixmatch">Mix & Match</button>
        <button class="nav-btn px-3 py-1 rounded" data-target="tools">Tools</button>
      </nav>

      <div class="flex items-center gap-3">
        <button id="themeToggle" title="Change theme" class="chip">Theme</button>
        <a href="#home" class="cta hidden md:inline-block">Start</a>
      </div>
    </div>
  </header>

  <main class="pt-28 pb-16">

    <section class="max-w-6xl mx-auto text-center px-4 py-12">
      <div class="rounded-2xl overflow-hidden card grid md:grid-cols-2 gap-6 items-center">
        <div class="p-6 text-left">
          <h1 class="text-3xl md:text-4xl font-bold mb-3">Temukan Outfit Terbaik Versi Dirimu</h1>
          <p class="text-muted mb-4">Rekomendasi outfit, colour harmony, style dictionary, mix & match, dan fitur lainnya ‚Äî sekarang dengan palette & vibe lebih kaya serta pengalaman dark theme yang lebih nyaman.</p>
          <div class="flex flex-wrap gap-3">
            <a href="#home" class="cta">Mulai Sekarang</a>
            <button id="exploreStyles" class="chip">Lihat Style Dictionary</button>
            <button id="tryPalette" class="chip">Jelajahi Colour Harmony</button>
          </div>
          <div class="mt-6 text-sm text-muted">Designed by Luna & Aurel ‚Äî Built with HTML, Tailwind, jQuery & Chart.js</div>
        </div>
        <div class="p-6 flex items-center justify-center">
          <div class="hero-media">
            <img src="beranda.jpg" alt="hero outfit modern" class="w-full h-full object-cover" />
          </div>
        </div>
      </div>
    </section>

    <section id="home" class="section max-w-3xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-blue-600 mb-3">Temukan Gaya yang Cocok Untukmu</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block font-semibold mb-1">Pilih Gender:</label>
            <select id="gender" class="w-full p-2 rounded">
              <option value="">-- Pilih --</option>
              <option value="female">Perempuan</option>
              <option value="male">Laki-laki</option>
            </select>
          </div>
          <div>
            <label class="block font-semibold mb-1">Pilih Warna Kulit:</label>
            <select id="skinTone" class="w-full p-2 rounded">
              <option value="">-- Pilih --</option>
              <option value="light">Light (Putih)</option>
              <option value="warm">Warm (Kuning Langsat)</option>
              <option value="medium">Medium (Sawo Matang)</option>
              <option value="deep">Deep (Gelap)</option>
            </select>
          </div>

          <div>
            <label class="block font-semibold mb-1">Pilih Acara:</label>
            <select id="occasion" class="w-full p-2 rounded">
              <option value="">-- Pilih --</option>
              <option value="casual">Kasual</option>
              <option value="formal">Formal</option>
              <option value="hangout">Hangout</option>
              <option value="campus">Kampus / Sekolah</option>
            </select>
          </div>
          <div>
            <label class="block font-semibold mb-1">Pilih Tempat (Indoor/Outdoor):</label>
            <select id="placeWhere" class="w-full p-2 rounded">
              <option value="">-- Pilih --</option>
              <option value="indoor">Indoor</option>
              <option value="outdoor">Outdoor</option>
            </select>
          </div>

          <div>
            <label class="block font-semibold mb-1">Cuaca / Musim:</label>
            <select id="weatherWhere" class="w-full p-2 rounded">
              <option value="">-- Pilih --</option>
              <option value="sunny">Cerah</option>
              <option value="rain">Hujan</option>
              <option value="cloudy">Mendung</option>
              <option value="hot">Terik</option>
              <option value="cold">Dingin</option>
            </select>
          </div>
          <div class="flex items-end">
            <button id="generateBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded">Lihat Rekomendasi</button>
          </div>
        </div>

        <div id="result" class="mt-6 p-4 rounded hidden">
          <h3 class="text-xl font-semibold text-blue-600">‚ú® Rekomendasi Kamu:</h3>
          <p id="styleResult" class="mt-2"></p>
          <p id="colors" class="mt-1"></p>
          <p id="outfit" class="mt-1"></p>
          <div id="suggestions" class="mt-3 grid sm:grid-cols-2 gap-2"></div>
        </div>
      </article>
    </section>

    <section id="color" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-blue-600">Colour Harmony</h2>
        <p class="text-sm muted mb-4">Klik palette untuk melihat kombinasi warna, simpan ke preferensi, dan lihat contoh cocok untuk style dan skin tone tertentu.</p>

        <div id="swatchGrid" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>

        <div class="mt-6 grid md:grid-cols-2 gap-4">
          <div class="card">
            <h3 class="font-semibold">Selected Palette</h3>
            <div id="selectedPalette" class="flex gap-2 mt-2"></div>
            <p id="paletteInfo" class="text-sm muted mt-2"></p>
            <div class="flex gap-2 mt-3">
              <button id="savePalette" class="bg-blue-600 text-white px-4 py-2 rounded">Simpan ke preferensi</button>
              <button id="applyToRecommender" class="bg-gray-100 px-4 py-2 rounded">Terapkan ke Rekomendasi</button>
            </div>
          </div>
          <div class="card">
            <h3 class="font-semibold">Skin Tone Harmony</h3>
            <div class="text-sm muted mb-3">Pilih skin tone atau palette untuk melihat sample kombinasi outfit dan vibes.</div>
            <canvas id="skinToneChart" width="400" height="200"></canvas>
            <p class="text-sm muted mt-2">Contoh visual rekomendasi warna.</p>
          </div>
        </div>
      </article>
    </section>

    <section id="style" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-blue-600">Style Dictionary</h2>
        <p class="text-sm muted mb-4">Klik card untuk melihat detail style. Saya tambahkan lebih banyak pilihan dan tag supaya pilihan terasa lengkap.</p>

        <div class="mb-4 flex gap-2 flex-wrap">
          <button class="filter-btn px-3 py-1 rounded bg-blue-600 text-white" data-filter="all">Semua</button>
          <button class="filter-btn px-3 py-1 rounded bg-gray-100" data-filter="modern">Modern</button>
          <button class="filter-btn px-3 py-1 rounded bg-gray-100" data-filter="classic">Classic</button>
          <button class="filter-btn px-3 py-1 rounded bg-gray-100" data-filter="street">Street</button>
          <button class="filter-btn px-3 py-1 rounded bg-gray-100" data-filter="elegant">Elegant</button>
          <button class="filter-btn px-3 py-1 rounded bg-gray-100" data-filter="minimal">Minimal</button>
          <button class="filter-btn px-3 py-1 rounded bg-gray-100" data-filter="retro">Retro</button>
        </div>

        <div id="styleGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"></div>
      </article>
    </section>

    <section id="mixmatch" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-blue-600">Mix & Match (Drag & Drop)</h2>
        <p class="text-sm muted mb-4">Seret item ke slot yang sesuai untuk menyusun outfit-mu. (Drop-to-slot yang valid ‚Äî UX lebih ketat agar tidak salah slot)</p>

        <div class="grid md:grid-cols-3 gap-4">
          <div id="mixItems" class="md:col-span-2 grid grid-cols-2 md:grid-cols-3 gap-3"></div>
          <div class="card">
            <h3 class="font-semibold">Your Outfit</h3>
            <div id="dropArea" class="mt-3 space-y-2">
              <div class="drop-slot p-2 border rounded" data-slot="top">Top: <span class="slot-val">‚Äî</span></div>
              <div class="drop-slot p-2 border rounded" data-slot="bottom">Bottom: <span class="slot-val">‚Äî</span></div>
              <div class="drop-slot p-2 border rounded" data-slot="shoes">Shoes: <span class="slot-val">‚Äî</span></div>
              <div class="drop-slot p-2 border rounded" data-slot="acc">Accessory: <span class="slot-val">‚Äî</span></div>
            </div>
            <button id="saveOutfit" class="mt-3 bg-blue-600 text-white px-3 py-2 rounded">Simpan Outfit</button>
          </div>
        </div>
      </article>
    </section>

    <section id="tools" class="section hidden-section max-w-6xl mx-auto px-4 py-8">
      <article class="card">
        <h2 class="text-2xl font-semibold text-blue-600">Tools</h2>
        <div class="grid md:grid-cols-3 gap-4 mt-4">

          <div class="card">
            <h3 class="font-semibold">What Vibes Are You?</h3>
            <div class="mt-3 grid grid-cols-2 gap-2">
              <button class="vibe-btn p-2 rounded bg-gray-100" data-vibe="cute">Cute</button>
              <button class="vibe-btn p-2 rounded bg-gray-100" data-vibe="minimal">Minimal</button>
              <button class="vibe-btn p-2 rounded bg-gray-100" data-vibe="elegant">Elegant</button>
              <button class="vibe-btn p-2 rounded bg-gray-100" data-vibe="cool">Cool</button>
              <button class="vibe-btn p-2 rounded bg-gray-100" data-vibe="cozy">Cozy</button>
              <button class="vibe-btn p-2 rounded bg-gray-100" data-vibe="street">Street</button>
            </div>
            <div id="vibeResult" class="mt-3 text-sm muted"></div>
          </div>

          <div class="card">
            <h3 class="font-semibold">Body Proportion Helper</h3>
            <input id="bpHeight" type="number" placeholder="Tinggi (cm)" class="w-full p-2 rounded mb-2" />
            <input id="bpWeight" type="number" placeholder="Berat (kg)" class="w-full p-2 rounded mb-2" />
            <select id="bpShape" class="w-full p-2 rounded mb-2">
              <option value="">Pilih bentuk tubuh (opsional)</option>
              <option value="petite">Petite</option>
              <option value="tall">Tall</option>
              <option value="curvy">Curvy</option>
              <option value="slim">Slim</option>
            </select>
            <button id="calcBP" class="mt-1 bg-blue-600 text-white px-3 py-2 rounded">Dapatkan Tips</button>
            <div id="bpResult" class="mt-3 text-sm muted"></div>
          </div>

          <div class="space-y-4">
            <div class="card">
              <h3 class="font-semibold">Outfit Weather Match</h3>
              <select id="weatherSel" class="w-full p-2 rounded mt-2">
                <option value="">Pilih Cuaca</option>
                <option value="sunny">Cerah</option>
                <option value="rain">Hujan</option>
                <option value="cloudy">Mendung</option>
                <option value="hot">Terik</option>
                <option value="cold">Dingin</option>
              </select>
              <select id="placeSel" class="w-full p-2 rounded mt-2">
                <option value="">Indoor / Outdoor?</option>
                <option value="indoor">Indoor</option>
                <option value="outdoor">Outdoor</option>
              </select>
              <button id="weatherBtn" class="mt-2 bg-blue-600 text-white px-3 py-2 rounded">Lihat Rekomendasi</button>
              <div id="weatherResult" class="mt-2 text-sm muted"></div>
            </div>

            <div class="card">
              <h3 class="font-semibold">Style Quiz (5 pertanyaan)</h3>
              <div id="quizArea" class="mt-2"></div>
              <button id="startQuiz" class="mt-2 bg-blue-600 text-white px-3 py-2 rounded">Mulai Quiz</button>
            </div>

            <div class="card">
              <h3 class="font-semibold">Outfit Randomizer (Gacha)</h3>
              <select id="gachaGender" class="w-full p-2 rounded mt-2">
                <option value="">Pilih Gender</option>
                <option value="female">Perempuan</option>
                <option value="male">Laki-laki</option>
              </select>
              <button id="gachaBtn" class="mt-2 bg-blue-600 text-white px-3 py-2 rounded">Random Outfit Today üé≤</button>
              <div id="gachaResult" class="mt-2 text-sm muted"></div>
            </div>
          </div>

        </div>
      </article>
    </section>

  </main>

  <div id="styleModal" class="hidden fixed inset-0 z-50 items-center justify-center">
    <div class="modal">
      <div class="flex justify-between items-start">
        <h3 id="modalTitle" class="text-xl font-bold"></h3>
        <button id="closeModal" class="text-xl">‚úï</button>
      </div>
      <img id="modalImg" src="https://via.placeholder.com/900x500/ADD8E6/ffffff?text=MODAL+IMAGE" alt="style image" class="w-full h-56 object-cover rounded mt-3" />
      <p id="modalDesc" class="text-muted mt-3"></p>
      <div id="modalTags" class="mt-3 flex gap-2 flex-wrap"></div>
    </div>
  </div>

  <footer class="max-w-6xl mx-auto text-center text-sm muted p-6">
    &copy; 2025 StyleMatch ‚Äî Luna & Aurel. Built with ‚ù§Ô∏è.
  </footer>

  <script>
  /* ======= Initialization & Safe helpers ======= */
  (function(){ /* isolate scope */
    // Simple helper
    function $(sel){ return jQuery(sel); }

    // Theme load from localStorage
    const savedTheme = localStorage.getItem('sm_theme') || 'light';
    document.body.className = 'theme-' + savedTheme;

    // Nav behavior
    function setActiveNav(target){
      $('.nav-btn').removeClass('active').css('background','').css('color','');
      $('.nav-btn[data-target="'+target+'"]').addClass('active');
    }

    // Show section helper
    function showSection(id){
      $('.section').addClass('hidden-section');
      $('#'+id).removeClass('hidden-section');
      setActiveNav(id);
      window.scrollTo({top:0,behavior:'smooth'});
    }

    // Initial: show home
    showSection('home');

    // Sidebar open/close
    $('#openSidebar').on('click', ()=> $('#sidebar').addClass('open'));
    $('#closeSidebar').on('click', ()=> $('#sidebar').removeClass('open'));
    $('#sidebar').on('click', (e)=> { if(e.target.id==='sidebar') $('#sidebar').removeClass('open'); });

    // Nav buttons (both sidebar and header)
    $(document).on('click','.nav-btn', function(){
      const t = $(this).data('target');
      if(t) showSection(t);
      $('#sidebar').removeClass('open');
    });

    // Theme buttons
    $('.theme-btn').on('click', function(){
      const t = $(this).data('theme') || 'light';
      document.body.className = 'theme-' + t;
      localStorage.setItem('sm_theme', t);
    });
    // toggle theme quick
    $('#themeToggle').on('click', function(){
      const current = (document.body.className || '').replace('theme-','') || 'light';
      const order = ['light','pinkblue','bluepurple','bluegreen','dark'];
      let i = order.indexOf(current);
      i = (i+1) % order.length;
      const next = order[i];
      document.body.className = 'theme-' + next;
      localStorage.setItem('sm_theme', next);
    });

    // Explore styles CTA
    $('#exploreStyles').on('click', ()=> showSection('style'));
    $('#tryPalette').on('click', ()=> showSection('color'));

    /* ======= Step A: Outfit Recommender (enhanced) ======= */
    function getOutfit(gender, skinTone, occasion){
      // more extensive mapping with skin-tone-aware palettes and multiple options
      const db = [
        { cond: {gender:'female', skin:'light', occ:'formal'}, val:{style:'Minimalist Formal', colors:['navy','beige','soft black'], outfit:'Blouse polos, midi skirt, heels netral', samples:['Blouse putih + midi beige','Navy blazer + skirt krem']} },
        { cond: {gender:'female', skin:'medium', occ:'hangout'}, val:{style:'Chic Casual', colors:['dusty pink','denim','off-white'], outfit:'Crop top, high-waist jeans, sneakers putih', samples:['Crop top dusty pink + denim'] } },
        { cond: {gender:'male', skin:'medium', occ:'casual'}, val:{style:'Casual Streetwear', colors:['olive','cream','denim'], outfit:'Kaos oversized, jeans biru, sneakers putih', samples:['Oversized tee + cargo pants']} },
        { cond: {gender:'male', occ:'formal'}, val:{style:'Smart Modern', colors:['black','grey','white'], outfit:'Kemeja polos, trousers fit, sepatu kulit', samples:['Grey suit + white shirt']} },
      ];
      // try to match best
      for(let r of db){
        const c = r.cond;
        if((!c.gender || c.gender===gender) && (!c.skin || c.skin===skinTone) && (!c.occ || c.occ===occasion)) return r.val;
      }
      return { style:'Universal Style', colors:['white','black','grey'], outfit:'Outfit netral cocok untuk semua warna kulit', samples:['White tee + jeans','Monochrome set'] };
    }

    $('#generateBtn').on('click', function(){
      const gender = $('#gender').val();
      const skin = $('#skinTone').val();
      const occ = $('#occasion').val();
      const place = $('#placeWhere').val();
      const weather = $('#weatherWhere').val();
      if(!gender || !skin || !occ){ alert('Lengkapi pilihan (gender, skin tone, occasion).'); return; }
      const base = getOutfit(gender, skin, occ);
      // adapt for weather & place
      let outfit = base.outfit;
      if(weather==='rain') outfit += ' + raincoat / waterproof';
      if(weather==='cold') outfit += ' + coat & knit';
      if(weather==='hot') outfit += ' + breathable linen';
      if(place==='outdoor') outfit += ' (suitable outdoor)';
      $('#styleResult').html('<strong>Gaya:</strong> '+base.style);
      $('#colors').html('<strong>Warna cocok:</strong> '+base.colors.join(', '));
      $('#outfit').html('<strong>Outfit:</strong> '+outfit);
      // show samples (visual suggestions)
      $('#suggestions').html((base.samples || []).map(s=>`<div class="p-3 rounded border muted">${s}</div>`).join(''));
      $('#result').removeClass('hidden');
      $('html,body').animate({scrollTop: $('#result').offset().top-80},300);
    });

    /* ======= Step B: Style Dictionary (JSON + render + modal) ======= */
    const styleData = [
      // URL Gambar Diperbarui ke Placeholder Universal
      { name:'Streetwear', category:'street', img:'stw.jpeg', desc:'Gaya kasual modern: hoodie, oversized, sneakers. Cocok untuk hangout & festival.', tags:['hangout','santai','youth'] },
      { name:'Vintage Classic', category:'classic', img:'vin.jpeg', desc:'Nuansa retro dengan warna earthy dan siluet klasik; cocok untuk pencinta detail dan tekstur.', tags:['retro','calm'] },
      { name:'Korean Minimalist', category:'modern', img:'kor.jpeg', desc:'Siluet bersih, warna netral, rapi. Ideal untuk look daily dan campus.', tags:['kuliah','office'] },
      { name:'Elegant Formal', category:'elegant', img:'elfor.jpeg', desc:'Blazer, dress, material premium untuk formal event.', tags:['kerja','kondangan'] },
      { name:'Techwear', category:'street', img:'tech.jpeg', desc:'Futuristik, banyak kantong, material waterproof. Cocok untuk outdoor urban.', tags:['outdoor','night'] },
      { name:'Soft Romantic', category:'minimal', img:'sorom.jpeg', desc:'Pastel, flowy, dan detail renda; vibe lembut & dreamy.', tags:['pastel','soft'] },
      { name:'Monochrome Chic', category:'modern', img:'mmn.jpeg', desc:'Monokrom yang elegan; bermain dengan tekstur bukan warna.', tags:['minimal','workwear'] }
    ];

    function renderGrid(filter='all'){
      $('#styleGrid').hide().html('');
      styleData.forEach((s,i)=>{
        if(filter!=='all' && s.category!==filter) return;
        const card = `<div class="card hover-raise cursor-pointer" role="button" data-index="${i}">
          <div class="w-full h-48 overflow-hidden rounded mb-2"><img src="${s.img}" alt="${s.name}" class="w-full h-full object-cover"></div>
          <h4 class="font-semibold">${s.name}</h4>
          <p class="text-sm muted">${s.desc.substring(0,80)}...</p>
        </div>`;
        $('#styleGrid').append(card);
      });
      $('#styleGrid').fadeIn(180);
    }
    renderGrid();

    $(document).on('click','.filter-btn', function(){
      $('.filter-btn').removeClass('bg-blue-600 text-white').addClass('bg-gray-100').removeClass('text-white');
      $(this).removeClass('bg-gray-100').addClass('bg-blue-600 text-white');
      const f = $(this).data('filter') || 'all';
      renderGrid(f);
    });

    // open modal
    $(document).on('click','#styleGrid [data-index]', function(){
      const i = $(this).data('index');
      const s = styleData[i];
      $('#modalTitle').text(s.name);
      // Memastikan URL gambar untuk modal juga diperbarui
      $('#modalImg').attr('src', s.img).attr('alt', s.name);
      $('#modalDesc').text(s.desc);
      $('#modalTags').html(s.tags.map(t=>`<span class="chip">${t}</span>`).join(' '));
      $('#styleModal').removeClass('hidden').addClass('modal-backdrop');
    });
    $('#closeModal').on('click', ()=> $('#styleModal').addClass('hidden').removeClass('modal-backdrop'));
    $('#styleModal').on('click', function(e){ if(e.target.id==='styleModal') { $(this).addClass('hidden').removeClass('modal-backdrop'); }});

    /* ======= Step C: Colour Harmony (palettes + chart + save) ======= */
    const palettes = [
      { id:'sunset', name:'Soft Sunset', colors:['#FFB6DA','#FFD1E8','#C7DDFF','#89A9FF'], desc:'Romantic pastel palette ‚Äî soft pink ke biru' },
      { id:'violet', name:'Blue ‚Üí Purple', colors:['#A9C7FF','#C3A6FF','#ECD9FF','#F6F0FF'], desc:'Cool & modern vibes' },
      { id:'ocean', name:'Ocean Fresh', colors:['#8BE8D4','#A4D8FF','#DFF7FF','#EAFBF7'], desc:'Fresh & natural ‚Äî cocok untuk kulit warm/medium' },
      { id:'earth', name:'Warm Earth', colors:['#D6A77A','#B86B4A','#F3E8DC','#8B5E3C'], desc:'Terracotta & warm' },
      { id:'mono', name:'Neutral Mono', colors:['#F8F9FA','#E9EEF6','#CBD5E1','#9AA8B2'], desc:'Minimal clean ‚Äî serbaguna untuk formal' },
      { id:'bold', name:'Bold Accent', colors:['#FF6B6B','#FFD166','#06D6A0','#4D96FF'], desc:'Kontras tajam untuk statement looks' },
      { id:'muted', name:'Muted Sophisticate', colors:['#E3D5FF','#D3EAFB','#FFF1E6','#E6E6E6'], desc:'Halus, cocok untuk office & chic' }
    ];

    function renderSwatches(){
      $('#swatchGrid').html('');
      palettes.forEach(p => {
        const inner = `<div class="p-3 card cursor-pointer" data-id="${p.id}">
          <div class="grid grid-cols-4 gap-1 mb-3">${p.colors.map(c=>`<div style="background:${c}" class="h-12 rounded"></div>`).join('')}</div>
          <div class="font-semibold">${p.name}</div>
          <div class="text-xs muted">${p.desc}</div>
        </div>`;
        $('#swatchGrid').append(inner);
      });
    }
    renderSwatches();

    // chart
    let skinChart = null;
    function initSkinChart(){
      const ctx = document.getElementById('skinToneChart').getContext('2d');
      skinChart = new Chart(ctx, {
        type:'pie',
        data:{labels:['Primary','Accent','Support','Neutral'], datasets:[{data:[40,25,20,15], backgroundColor:palettes[0].colors.slice(0,4)}]},
        options:{responsive:true, plugins:{legend:{position:'bottom'}}}
      });
    }
    initSkinChart();

    $(document).on('click','#swatchGrid .card', function(){
      const id = $(this).data('id');
      const p = palettes.find(x=>x.id===id);
      $('#selectedPalette').html(p.colors.map(c=>`<div style="background:${c}" class="w-14 h-10 rounded border"></div>`).join(''));
      $('#paletteInfo').text(p.desc);
      // update chart
      skinChart.data.datasets[0].backgroundColor = p.colors.slice(0,4);
      skinChart.update();
    });
    $('#savePalette').on('click', function(){
      const cols = $('#selectedPalette div').map((i,el)=>$(el).css('background-color')).get();
      if(!cols.length){ alert('Pilih palette dulu'); return; }
      localStorage.setItem('sm_palette', JSON.stringify(cols));
      alert('Palette disimpan ke preferensi!');
    });
    // apply palette to recommender
    $('#applyToRecommender').on('click', function(){
      const cols = JSON.parse(localStorage.getItem('sm_palette') || '[]');
      if(!cols.length){ alert('Tidak ada palette tersimpan. Pilih dan simpan terlebih dahulu.'); return; }
      // Simple UX: show first color as suggestion in result area
      $('#colors').html('<strong>Warna pilih (applied):</strong> ' + cols.join(', '));
      alert('Palette diterapkan ke rekomendasi (sementara).');
    });
    // load saved palette
    if(localStorage.getItem('sm_palette')){
      const arr = JSON.parse(localStorage.getItem('sm_palette'));
      $('#selectedPalette').html(arr.map(c=>`<div style="background:${c}" class="w-14 h-10 rounded border"></div>`).join(''));
    }

    /* ======= Step E: Mix & Match (drag & drop) ======= */
    const mixItems = [
      // URL Gambar Diperbarui ke Placeholder Universal
      { id:'t1', slot:'top', name:'White Tee', img:'whitetee.jpg' },
      { id:'t2', slot:'top', name:'Hoodie', img:'hoodie.jpg' },
      { id:'b1', slot:'bottom', name:'Blue Jeans', img:'bluej.jpg' },
      { id:'b2', slot:'bottom', name:'Cargo Pants', img:'cargo.jpg' },
      { id:'s1', slot:'shoes', name:'Sneakers', img:'Sneakers.jpg' },
      { id:'a1', slot:'acc', name:'Beanie', img:'beanie.jpg' }
    ];
    function renderMixItems(){
      $('#mixItems').html('');
      mixItems.forEach(it=>{
        const el = `<div draggable="true" data-id="${it.id}" data-slot="${it.slot}" class="card cursor-grab">
          <div class="w-full h-36 overflow-hidden rounded mb-2"><img src="${it.img}" alt="${it.name}" class="w-full h-full object-cover" /></div>
          <div class="font-semibold">${it.name}</div><div class="text-xs muted">slot: ${it.slot}</div>
        </div>`;
        $('#mixItems').append(el);
      });
    }
    renderMixItems();

    // drag & drop
    let dragData = null;
    $(document).on('dragstart','[draggable="true"]', function(e){ dragData = { id: $(this).data('id'), slot: $(this).data('slot'), name: $(this).find('.font-semibold').text() }; });
    $('.drop-slot').each(function(){
      this.addEventListener('dragover', function(e){ e.preventDefault(); });
      this.addEventListener('drop', function(e){
        const target = $(this);
        if(!dragData) return;
        const slot = target.data('slot');
        if(slot !== dragData.slot){ alert('Salah slot! Drop ke slot yang sesuai.'); return; }
        target.find('.slot-val').text(dragData.name);
        target.data('item', dragData.id);
        dragData = null;
      });
    });
    $('#saveOutfit').on('click', function(){
      const out = {};
      $('.drop-slot').each(function(){ out[$(this).data('slot')] = $(this).data('item') || null; });
      localStorage.setItem('sm_savedOutfit', JSON.stringify(out));
      alert('Outfit disimpan!');
    });

    /* ======= Step F: Vibe & Body Proportion ======= */
    const vibeMap = {
      cute:{desc:'Soft pastel, playful silhouettes', colors:['#FFD6E0','#FFDCAE','#C7DDFF']},
      minimal:{desc:'Neutral tones, clean lines', colors:['#F8FAFC','#CBD5E1','#9AA8B2']},
      elegant:{desc:'Tailored, richer fabrics', colors:['#1F2937','#6B7280','#F3E8DC']},
      cool:{desc:'Street/edgy pieces, monochrome', colors:['#0F172A','#334155','#89A9FF']},
      cozy:{desc:'Layered knits, warm tones', colors:['#F7D6B3','#C6A78B','#EAFBF7']},
      street:{desc:'Casual urban, practical', colors:['#111827','#6B7280','#B8B8B8']}
    };
    $(document).on('click','.vibe-btn', function(){
      const v = $(this).data('vibe');
      const info = vibeMap[v];
      $('#vibeResult').html(`<strong>${v.toUpperCase()}</strong><p class="text-sm">${info.desc}</p><div class="flex gap-2 mt-2">${info.colors.map(c=>`<div style="background:${c}" class="w-10 h-8 rounded"></div>`).join('')}</div>`);
      localStorage.setItem('sm_lastVibe', v);
    });

    $('#calcBP').on('click', function(){
      const h = parseFloat($('#bpHeight').val());
      const w = parseFloat($('#bpWeight').val());
      const shape = $('#bpShape').val();
      if(!h || !w){ alert('Isi tinggi & berat dulu'); return; }
      const bmi = (w / ((h/100)*(h/100))).toFixed(1);
      let tips = `BMI: ${bmi}. Umum: pilih potongan yang seimbang dengan proporsimu. `;
      if(h < 160) tips += 'Petite tips: high-waist & vertical lines untuk tampak lebih tinggi. ';
      if(h >= 180) tips += 'Tall tips: coba cropped tops & belting untuk seimbangkan torso. ';
      if(shape==='curvy') tips += 'Curvy tips: wrap dress & V-neck flattering. ';
      $('#bpResult').text(tips);
    });

    /* ======= Step G: Weather, Quiz, Gacha ======= */
    const weatherMap = {
      sunny:'Kaos ringan, topi, kacamata hitam',
      rain:'Hoodie + waterproof jacket, sepatu anti air',
      cloudy:'Layering ringan, jaket tipis',
      hot:'Atasan adem, celana pendek / linen',
      cold:'Coat, knit, boots'
    };
    $('#weatherBtn').on('click', function(){
      const w = $('#weatherSel').val(); const p = $('#placeSel').val();
      if(!w || !p){ alert('Pilih cuaca & tempat dulu'); return; }
      const r = weatherMap[w] + (p==='outdoor' ? ' (sesuaikan alas kaki outdoor)' : ' (pilih bahan nyaman)');
      $('#weatherResult').text(r);
    });

    // Quiz (improved: mapping more nuanced result + palette suggestions)
    const quizQs = [
      {q:'Warna favoritmu?', opts:['Pastel','Netral','Bold','Monochrome']},
      {q:'Tujuan outfit?', opts:['Hangout','Formal','Kampus','Foto']},
      {q:'Pilih item:', opts:['Dress/Skirt','Jeans','Oversized Tee','Tailored Blazer']},
      {q:'Vibe yang kamu suka?', opts:['Cute','Minimal','Elegant','Street']},
      {q:'Pola & Tekstur?', opts:['Plain','Floral','Denim','Leather']}
    ];
    function renderQuiz(){
      $('#quizArea').html('');
      quizQs.forEach((q,i)=>{
        const html = `<div class="mb-3">
          <div class="font-semibold">${i+1}. ${q.q}</div>
          <div class="mt-2 grid grid-cols-2 gap-2">${q.opts.map(o=>`<button class="quiz-opt p-2 border rounded" data-q="${i}" data-val="${o}">${o}</button>`).join('')}</div>
        </div>`;
        $('#quizArea').append(html);
      });
      $('#quizArea').append('<button id="submitQuiz" class="mt-2 bg-green-600 text-white px-3 py-2 rounded">Submit Quiz</button>');
    }
    $('#startQuiz').on('click', function(){ renderQuiz(); $('html,body').animate({scrollTop: $('#quizArea').offset().top-80},300); });
    let quizAnswers = {};
    $(document).on('click','.quiz-opt', function(){
      const q = $(this).data('q'), val = $(this).data('val');
      quizAnswers[q] = val;
      $(this).siblings().removeClass('bg-blue-600 text-white');
      $(this).addClass('bg-blue-600 text-white');
    });
    $(document).on('click','#submitQuiz', function(){
      const picks = Object.values(quizAnswers).join(' ');
      // more nuanced heuristics
      let result = 'Soft Autumn Minimalist';
      let palette = 'mono';
      if(picks.includes('Bold') || picks.includes('Oversized')) { result = 'Streetwear Bold'; palette='bold'; }
      if(picks.includes('Elegant') || picks.includes('Blazer')) { result = 'Elegant Formal'; palette='muted'; }
      if(picks.includes('Pastel') && picks.includes('Cute')) { result = 'Soft Romantic'; palette='sunset'; }
      if(picks.includes('Monochrome')) { result = 'Monochrome Chic'; palette='mono'; }
      $('#quizArea').html(`<div class="p-4 rounded card"><strong>Hasil:</strong> ${result}<p class="mt-2 text-sm muted">Saran palette: ${palette}. Coba lihat Colour Harmony untuk contoh kombinasi.</p></div>`);
      // preselect palette in UI if available
      const selPal = palettes.find(p=>p.id===palette);
      if(selPal){
        $('#selectedPalette').html(selPal.colors.map(c=>`<div style="background:${c}" class="w-14 h-10 rounded border"></div>`).join(''));
        $('#paletteInfo').text(selPal.desc);
        skinChart.data.datasets[0].backgroundColor = selPal.colors.slice(0,4);
        skinChart.update();
      }
    });

    // Gacha
    const outfits = [
      {gender:'male', name:'Casual Weekend', items:['Tee','Jeans','Sneakers'], desc:'Casual tee + denim + sneakers'},
      {gender:'female', name:'Date Night', items:['Blouse','Midi Skirt','Heels'], desc:'Soft blouse + midi skirt'},
      {gender:'male', name:'Smart Modern', items:['Shirt','Trousers','Loafers'], desc:'Button-up + trousers'},
      {gender:'female', name:'Korean Minimal', items:['Oversized Knit','Wide Pants','Sneakers'], desc:'Clean neutral look'},
    ];
    $('#gachaBtn').on('click', function(){
      const g = $('#gachaGender').val(); if(!g){ alert('Pilih gender dulu'); return; }
      const pool = outfits.filter(o=>o.gender===g); if(!pool.length){ $('#gachaResult').text('No outfit for this gender.'); return; }
      const pick = pool[Math.floor(Math.random()*pool.length)];
      $('#gachaResult').html(`<strong>${pick.name}</strong><div class="text-sm mt-1 muted">${pick.desc}</div>`);
    });

    /* ======= small UX additions & accessibility ======= */
    // active nav on scroll (sections)
    const sections = ['home','color','style','mixmatch','tools'];
    $(window).on('scroll', function(){
      const sTop = $(window).scrollTop() + 120;
      for(let id of sections){
        const el = $('#'+id);
        if(el.length){
          const top = el.offset().top, h = el.outerHeight();
          if(sTop >= top && sTop < top + h){ setActiveNav(id); break; }
        }
      }
    });

    // ensure chart resized when tab shown
    $(document).on('click', '[data-target="color"]', function(){ setTimeout(()=> { if(skinChart) skinChart.resize(); },300); });

    // load saved theme/palette/outfit
    if(localStorage.getItem('sm_savedOutfit')){
      const saved = JSON.parse(localStorage.getItem('sm_savedOutfit'));
      $('.drop-slot').each(function(){ const s=$(this).data('slot'); if(saved[s]) $(this).find('.slot-val').text(saved[s]); });
    }

    // A11y: keyboard nav for sidebar close
    $(document).on('keydown', function(e){ if(e.key === 'Escape'){ $('#sidebar').removeClass('open'); $('#styleModal').addClass('hidden').removeClass('modal-backdrop'); } });

    // polish done
  })();
  </script>
</body>
</html>